# åŸºé€ŸåŸºé‡‘é‡åŒ–åˆ†æå¹³å° - åŸºé‡‘æ¢ç´¢ç•Œé¢UIæ¶æ„æ–‡æ¡£

## ğŸ“‹ ä»‹ç»

### æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£å®šä¹‰äº†åŸºé€ŸåŸºé‡‘é‡åŒ–åˆ†æå¹³å°åŸºé‡‘æ¢ç´¢ç•Œé¢é‡æ„çš„å‰ç«¯æ¶æ„è®¾è®¡ï¼Œä¸ºå¼€å‘å›¢é˜Ÿæä¾›æŠ€æœ¯å®æ–½æŒ‡å¯¼ã€‚åŸºäºç°æœ‰çš„Flutteræ¶æ„ï¼Œæˆ‘ä»¬è¿›è¡Œæç®€è®¾è®¡çš„UIé‡æ„ï¼Œå°†æ¦‚è§ˆç•Œé¢é›†æˆåˆ°åŸºé‡‘æ¢ç´¢ä¸»é¡µï¼Œä¿æŒåŠŸèƒ½å®Œæ•´æ€§çš„åŒæ—¶æå‡ç”¨æˆ·ä½“éªŒã€‚

### é‡æ„ç›®æ ‡

- **æç®€è®¾è®¡** - ç§»é™¤è§†è§‰å™ªéŸ³ï¼Œçªå‡ºæ ¸å¿ƒä¿¡æ¯
- **æ¦‚è§ˆé›†æˆ** - å°†å¸‚åœºæ¦‚è§ˆæ— ç¼é›†æˆåˆ°åŸºé‡‘æ¢ç´¢ä¸»é¡µ
- **å¾®äº¤äº’ä¼˜åŒ–** - æä¾›æµç•…çš„åŠ¨ç”»å’Œäº¤äº’åé¦ˆ
- **æ€§èƒ½æå‡** - ä¼˜åŒ–åŠ è½½é€Ÿåº¦å’Œå“åº”æ€§èƒ½
- **åŠŸèƒ½æ•´åˆ** - ç»Ÿä¸€æœç´¢æœåŠ¡å’Œå·¥å…·é¢æ¿

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| Category | Technology | Version | Purpose | Rationale |
|---------|------------|---------|---------|-----------|
| **Framework** | Flutter | 3.13.0+ | è·¨å¹³å°UIå¼€å‘æ¡†æ¶ | ç°æœ‰é¡¹ç›®åŸºç¡€ï¼Œæˆç†Ÿçš„è·¨å¹³å°è§£å†³æ–¹æ¡ˆ |
| **State Management** | flutter_bloc | 8.1.0+ | å“åº”å¼çŠ¶æ€ç®¡ç† | ç°æœ‰é¡¹ç›®é‡‡ç”¨ï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡é€»è¾‘ |
| **UI Components** | Material Design 3 | Latest | è®¾è®¡ç³»ç»Ÿç»„ä»¶åº“ | ç¬¦åˆæç®€è®¾è®¡åŸåˆ™ï¼ŒåŸç”ŸFlutteræ”¯æŒ |
| **Animation** | flutter_animate | 4.2.0+ | å¾®äº¤äº’å’ŒåŠ¨ç”»æ•ˆæœ | æ”¯æŒUXè§„æ ¼ä¸­çš„åŠ¨ç”»éœ€æ±‚ |
| **Network** | Dio + Retrofit | 5.3.0+ | HTTPå®¢æˆ·ç«¯å’ŒAPIé›†æˆ | ç°æœ‰ç½‘ç»œå±‚ï¼Œç±»å‹å®‰å…¨çš„APIè°ƒç”¨ |
| **Data Storage** | Hive + shared_preferences | 2.2.0+ | æœ¬åœ°æ•°æ®ç¼“å­˜ | é«˜æ€§èƒ½æœ¬åœ°å­˜å‚¨ï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢ |
| **Charts** | fl_chart | 0.65.0+ | æ•°æ®å¯è§†åŒ– | é‡‘èæ•°æ®å›¾è¡¨å±•ç¤º |
| **Dependency Injection** | get_it | 7.6.0+ | æœåŠ¡å®šä½å’Œä¾èµ–æ³¨å…¥ | æ¾è€¦åˆæ¶æ„ï¼Œæ˜“äºæµ‹è¯• |
| **Navigation** | GoRouter | 12.1.0+ | å£°æ˜å¼è·¯ç”±ç®¡ç† | ç°ä»£åŒ–çš„è·¯ç”±è§£å†³æ–¹æ¡ˆ |
| **Internationalization** | flutter_localizations | Latest | å¤šè¯­è¨€æ”¯æŒ | ä¸­æ–‡ä¸ºä¸»çš„æœ¬åœ°åŒ–éœ€æ±‚ |
| **Testing** | flutter_test + mockito | Latest | å•å…ƒå’Œé›†æˆæµ‹è¯• | ä¿è¯ä»£ç è´¨é‡å’Œç¨³å®šæ€§ |

## ğŸ“ é¡¹ç›®ç»“æ„

### æ•´ä½“æ¶æ„

```
lib/
â”œâ”€â”€ main.dart                              # åº”ç”¨å…¥å£ç‚¹
â”œâ”€â”€ app.dart                               # åº”ç”¨é…ç½®å’Œä¸»é¢˜è®¾ç½®
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                              # æ ¸å¿ƒæ¨¡å—å’Œå…±äº«å·¥å…·
â”‚   â”‚   â”œâ”€â”€ constants/                     # å¸¸é‡å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ utils/                         # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ themes/                        # ä¸»é¢˜å’Œæ ·å¼
â”‚   â”‚   â”œâ”€â”€ extensions/                    # æ‰©å±•æ–¹æ³•
â”‚   â”‚   â””â”€â”€ widgets/                       # é€šç”¨ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ shared/                           # å…±äº«çš„é¢†åŸŸæ¨¡å‹å’Œæ•°æ®ç±»å‹
â”‚   â”‚   â”œâ”€â”€ models/                       # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ repositories/                  # æ•°æ®ä»“åº“æ¥å£
â”‚   â”‚   â””â”€â”€ services/                      # åŸºç¡€æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ features/                         # åŠŸèƒ½æ¨¡å—ï¼ˆClean Architectureï¼‰
â”‚   â”‚   â”œâ”€â”€ fund_exploration/             # åŸºé‡‘æ¢ç´¢æ¨¡å—ï¼ˆé‡æ„é‡ç‚¹ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ data/                     # æ•°æ®å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/                   # é¢†åŸŸå±‚
â”‚   â”‚   â”‚   â””â”€â”€ presentation/             # è¡¨ç°å±‚
â”‚   â”‚   â”œâ”€â”€ fund_comparison/              # åŸºé‡‘å¯¹æ¯”æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ portfolio/                     # æŠ•èµ„ç»„åˆæ¨¡å—
â”‚   â”‚   â””â”€â”€ settings/                      # è®¾ç½®æ¨¡å—
â”‚   â”‚
â”‚   â”œâ”€â”€ navigation/                       # å¯¼èˆªå’Œè·¯ç”±
â”‚   â””â”€â”€ injection/                        # ä¾èµ–æ³¨å…¥é…ç½®
â”‚
â”œâ”€â”€ assets/                              # èµ„æºæ–‡ä»¶
â””â”€â”€ test/                               # æµ‹è¯•æ–‡ä»¶
```

### åŸºé‡‘æ¢ç´¢æ¨¡å—ç»“æ„

```
src/features/fund_exploration/
â”œâ”€â”€ data/                     # æ•°æ®å±‚
â”‚   â”œâ”€â”€ datasources/         # æ•°æ®æºå®ç°
â”‚   â”‚   â”œâ”€â”€ market_data_source.dart    # å¸‚åœºæ•°æ®æº
â”‚   â”‚   â”œâ”€â”€ fund_data_source.dart      # åŸºé‡‘æ•°æ®æº
â”‚   â”‚   â””â”€â”€ remote_data_source.dart    # è¿œç¨‹æ•°æ®æº
â”‚   â”œâ”€â”€ repositories/        # ä»“åº“å®ç°
â”‚   â”‚   â”œâ”€â”€ market_repository.dart     # å¸‚åœºæ•°æ®ä»“åº“
â”‚   â”‚   â”œâ”€â”€ fund_repository.dart       # åŸºé‡‘æ•°æ®ä»“åº“
â”‚   â”‚   â””â”€â”€ search_repository.dart     # æœç´¢æ•°æ®ä»“åº“
â”‚   â””â”€â”€ models/              # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚       â”œâ”€â”€ market_models.dart         # å¸‚åœºæ•°æ®æ¨¡å‹
â”‚       â”œâ”€â”€ fund_models.dart           # åŸºé‡‘æ•°æ®æ¨¡å‹
â”‚       â””â”€â”€ search_models.dart         # æœç´¢æ•°æ®æ¨¡å‹
â”œâ”€â”€ domain/                  # é¢†åŸŸå±‚
â”‚   â”œâ”€â”€ entities/           # ä¸šåŠ¡å®ä½“
â”‚   â”‚   â”œâ”€â”€ market_index.dart          # å¸‚åœºæŒ‡æ•°å®ä½“
â”‚   â”‚   â”œâ”€â”€ fund.dart                  # åŸºé‡‘å®ä½“
â”‚   â”‚   â””â”€â”€ market_overview.dart       # å¸‚åœºæ¦‚è§ˆå®ä½“
â”‚   â”œâ”€â”€ repositories/        # ä»“åº“æ¥å£
â”‚   â”‚   â”œâ”€â”€ i_market_repository.dart   # å¸‚åœºä»“åº“æ¥å£
â”‚   â”‚   â”œâ”€â”€ i_fund_repository.dart     # åŸºé‡‘ä»“åº“æ¥å£
â”‚   â”‚   â””â”€â”€ i_search_repository.dart   # æœç´¢ä»“åº“æ¥å£
â”‚   â””â”€â”€ usecases/            # ç”¨ä¾‹
â”‚       â”œâ”€â”€ get_market_overview.dart   # è·å–å¸‚åœºæ¦‚è§ˆç”¨ä¾‹
â”‚       â”œâ”€â”€ search_funds.dart          # æœç´¢åŸºé‡‘ç”¨ä¾‹
â”‚       â””â”€â”€ get_fund_recommendations.dart # è·å–æ¨èç”¨ä¾‹
â””â”€â”€ presentation/           # è¡¨ç°å±‚
    â”œâ”€â”€ bloc/                # BLoCçŠ¶æ€ç®¡ç†
    â”‚   â”œâ”€â”€ fund_exploration_bloc.dart # ä¸»é¡µBLoC
    â”‚   â”œâ”€â”€ market_overview_bloc.dart  # å¸‚åœºæ¦‚è§ˆBLoC
    â”‚   â”œâ”€â”€ fund_search_bloc.dart      # åŸºé‡‘æœç´¢BLoC
    â”‚   â””â”€â”€ fund_recommendations_bloc.dart # æ¨èBLoC
    â”œâ”€â”€ pages/               # é¡µé¢
    â”‚   â””â”€â”€ fund_exploration_page.dart # åŸºé‡‘æ¢ç´¢ä¸»é¡µ
    â””â”€â”€ widgets/             # ç»„ä»¶
        â”œâ”€â”€ overview/         # æ¦‚è§ˆç›¸å…³ç»„ä»¶
        â”‚   â”œâ”€â”€ market_overview_widget.dart  # å¸‚åœºæ¦‚è§ˆç»„ä»¶
        â”‚   â”œâ”€â”€ market_index_card.dart       # æ¸‚åœºæŒ‡æ•°å¡ç‰‡
        â”‚   â””â”€â”€ hot_funds_list.dart          # çƒ­é—¨åŸºé‡‘åˆ—è¡¨
        â”œâ”€â”€ search/          # æœç´¢ç›¸å…³ç»„ä»¶
        â”‚   â”œâ”€â”€ unified_search_box.dart     # ç»Ÿä¸€æœç´¢æ¡†
        â”‚   â””â”€â”€ search_suggestions_list.dart # æœç´¢å»ºè®®åˆ—è¡¨
        â”œâ”€â”€ cards/           # å¡ç‰‡ç»„ä»¶
        â”‚   â”œâ”€â”€ fund_card.dart              # åŸºé‡‘å¡ç‰‡
        â”‚   â””â”€â”€ recommendation_card.dart    # æ¨èå¡ç‰‡
        â”œâ”€â”€ panels/          # é¢æ¿ç»„ä»¶
        â”‚   â”œâ”€â”€ tools_panel.dart           # å·¥å…·é¢æ¿
        â”‚   â””â”€â”€ filter_panel.dart          # ç­›é€‰é¢æ¿
        â””â”€â”€ common/          # é€šç”¨ç»„ä»¶
            â”œâ”€â”€ loading_widget.dart        # åŠ è½½ç»„ä»¶
            â””â”€â”€ error_widget.dart          # é”™è¯¯ç»„ä»¶
```

## ğŸ§© ç»„ä»¶æ ‡å‡†

### ç»„ä»¶æ¨¡æ¿

é‡‡ç”¨BLoCæ¨¡å¼çš„æ ‡å‡†ç»„ä»¶æ¨¡æ¿ï¼š

```dart
// 1. äº‹ä»¶å®šä¹‰
abstract class ComponentEvent extends Equatable {
  const ComponentEvent();

  @override
  List<Object> get props => [];
}

class ComponentLoadRequested extends ComponentEvent {}

// 2. çŠ¶æ€å®šä¹‰
abstract class ComponentState extends Equatable {
  const ComponentState();

  @override
  List<Object> get props => [];
}

class ComponentInitial extends ComponentState {}

class ComponentLoadInProgress extends ComponentState {}

class ComponentLoadSuccess extends ComponentState {
  final List<ModelType> data;

  const ComponentLoadSuccess(this.data);

  @override
  List<Object> get props => [data];
}

class ComponentLoadFailure extends ComponentState {
  final String error;

  const ComponentLoadFailure(this.error);

  @override
  List<Object> get props => [error];
}

// 3. BLoCå®ç°
class ComponentBloc extends Bloc<ComponentEvent, ComponentState> {
  final RepositoryType _repository;

  ComponentBloc({required RepositoryType repository})
      : _repository = repository,
        super(ComponentInitial()) {
    on<ComponentLoadRequested>(_onLoadRequested);
  }

  Future<void> _onLoadRequested(
    ComponentLoadRequested event,
    Emitter<ComponentState> emit,
  ) async {
    emit(ComponentLoadInProgress());
    try {
      final data = await _repository.methodName();
      emit(ComponentLoadSuccess(data));
    } catch (e) {
      emit(ComponentLoadFailure(e.toString()));
    }
  }
}

// 4. ç»„ä»¶å®ç°
class Component extends StatelessWidget {
  const Component({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (context) => ComponentBloc(
        repository: context.read<RepositoryType>(),
      )..add(ComponentLoadRequested()),
      child: const ComponentView(),
    );
  }
}

class ComponentView extends StatelessWidget {
  const ComponentView({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return BlocBuilder<ComponentBloc, ComponentState>(
      builder: (context, state) {
        switch (state.runtimeType) {
          case ComponentLoadInProgress:
            return const LoadingWidget();
          case ComponentLoadSuccess:
            return SuccessWidget(data: (state as ComponentLoadSuccess).data);
          case ComponentLoadFailure:
            return ErrorWidget(
              error: (state as ComponentLoadFailure).error,
              onRetry: () => context.read<ComponentBloc>().add(ComponentLoadRequested()),
            );
          default:
            return const SizedBox.shrink();
        }
      },
    );
  }
}
```

### å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**: `kebab_case.dart` (ä¾‹: `fund_card.dart`)
- **BLoCç±»**: `PascalCaseBloc` (ä¾‹: `FundSearchBloc`)
- **äº‹ä»¶ç±»**: `PascalCaseEvent` (ä¾‹: `FundSearchLoadRequested`)
- **çŠ¶æ€ç±»**: `PascalCaseState` (ä¾‹: `FundSearchLoadSuccess`)
- **æ¨¡å‹ç±»**: `PascalCase` (ä¾‹: `Fund`, `SearchFilter`)

## ğŸ”„ çŠ¶æ€ç®¡ç†æ¶æ„

### ç»Ÿä¸€æœç´¢æœåŠ¡çŠ¶æ€ç®¡ç†

```dart
// ç»Ÿä¸€æœç´¢äº‹ä»¶
abstract class UnifiedSearchEvent extends Equatable {
  const UnifiedSearchEvent();

  @override
  List<Object> get props => [];
}

class SearchQueryChanged extends UnifiedSearchEvent {
  final String query;

  const SearchQueryChanged(this.query);

  @override
  List<Object> get props => [query];
}

class SearchSubmitted extends UnifiedSearchEvent {
  final String query;
  final SearchFilters filters;

  const SearchSubmitted(this.query, this.filters);

  @override
  List<Object> get props => [query, filters];
}

// ç»Ÿä¸€æœç´¢çŠ¶æ€
abstract class UnifiedSearchState extends Equatable {
  const UnifiedSearchState();

  @override
  List<Object> get props => [];
}

class UnifiedSearchLoaded extends UnifiedSearchState {
  final List<Fund> searchResults;
  final List<String> suggestions;
  final List<String> searchHistory;
  final String currentQuery;
  final SearchFilters currentFilters;
  final bool isLoading;
  final String? error;

  const UnifiedSearchLoaded({
    required this.searchResults,
    required this.suggestions,
    required this.searchHistory,
    required this.currentQuery,
    required this.currentFilters,
    this.isLoading = false,
    this.error,
  });

  @override
  List<Object> get props => [
        searchResults,
        suggestions,
        searchHistory,
        currentQuery,
        currentFilters,
        isLoading,
        error,
      ];
}

// ç»Ÿä¸€æœç´¢BLoC
class UnifiedSearchBloc extends Bloc<UnifiedSearchEvent, UnifiedSearchState> {
  final UnifiedSearchRepository _searchRepository;
  final CacheService _cacheService;
  final UserPreferenceService _preferenceService;

  Timer? _debounceTimer;
  static const _debounceDuration = Duration(milliseconds: 300);

  UnifiedSearchBloc({
    required UnifiedSearchRepository searchRepository,
    required CacheService cacheService,
    required UserPreferenceService preferenceService,
  })  : _searchRepository = searchRepository,
        _cacheService = cacheService,
        _preferenceService = preferenceService,
        super(UnifiedSearchInitial()) {
    on<SearchQueryChanged>(_onSearchQueryChanged);
    on<SearchSubmitted>(_onSearchSubmitted);
  }

  Future<void> _onSearchQueryChanged(
    SearchQueryChanged event,
    Emitter<UnifiedSearchState> emit,
  ) async {
    _debounceTimer?.cancel();

    // é˜²æŠ–å¤„ç†æœç´¢å»ºè®®
    _debounceTimer = Timer(_debounceDuration, () {
      add(SearchSuggestionRequested(event.query));
    });
  }

  Future<void> _onSearchSubmitted(
    SearchSubmitted event,
    Emitter<UnifiedSearchState> emit,
  ) async {
    _debounceTimer?.cancel();

    try {
      emit(UnifiedSearchLoaded(
        searchResults: [],
        suggestions: [],
        searchHistory: state is UnifiedSearchLoaded ? state.searchHistory : [],
        currentQuery: event.query,
        currentFilters: event.filters,
        isLoading: true,
      ));

      // æ£€æŸ¥ç¼“å­˜
      final cacheKey = _generateCacheKey(event.query, event.filters);
      final cachedResults = await _cacheService.getSearchResults(cacheKey);

      if (cachedResults != null) {
        emit(UnifiedSearchLoaded(
          searchResults: cachedResults,
          suggestions: [],
          searchHistory: state is UnifiedSearchLoaded ? state.searchHistory : [],
          currentQuery: event.query,
          currentFilters: event.filters,
          isLoading: false,
        ));
        return;
      }

      // æ‰§è¡Œæœç´¢
      final results = await _searchRepository.searchFunds(
        event.query,
        filters: event.filters,
      );

      // ç¼“å­˜ç»“æœ
      await _cacheService.saveSearchResults(cacheKey, results);

      // ä¿å­˜æœç´¢å†å²
      await _preferenceService.addToSearchHistory(event.query);

      emit(UnifiedSearchLoaded(
        searchResults: results,
        suggestions: [],
        searchHistory: state is UnifiedSearchLoaded
            ? [...state.searchHistory, event.query].take(10).toList()
            : [event.query],
        currentQuery: event.query,
        currentFilters: event.filters,
        isLoading: false,
      ));
    } catch (e) {
      emit(UnifiedSearchError(
        error: e.toString(),
        previousQuery: event.query,
      ));
    }
  }
}
```

## ğŸŒ APIé›†æˆæ¶æ„

### APIå®¢æˆ·ç«¯é…ç½®

```dart
@RestApi(baseUrl: 'http://154.44.25.92:8080')
@injectable
abstract class ApiClient {
  @factoryMethod
  factory ApiClient(Dio dio) = _ApiClient;

  // åŸºé‡‘ç›¸å…³API
  @GET('/api/funds')
  Future<ApiResponse<List<FundDto>>> getFunds(
    @Query('page') int page,
    @Query('size') int size,
    @Query('type') String? fundType,
    @Query('sort') String? sortBy,
  );

  @GET('/api/funds/search')
  Future<ApiResponse<List<FundDto>>> searchFunds(
    @Query('q') String query,
    @Query('type') String? fundType,
    @Query('risk') String? riskLevel,
    @Query('minReturn') double? minReturn,
    @Query('maxReturn') double? maxReturn,
  );

  @GET('/api/funds/recommendations')
  Future<ApiResponse<List<FundRecommendationDto>>> getFundRecommendations(
    @Query('userId') String? userId,
    @Query('limit') int limit,
  );

  // å¯¹æ¯”ç›¸å…³API
  @POST('/api/funds/compare')
  Future<ApiResponse<FundComparisonDto>> compareFunds(
    @Body() CompareFundsRequest request,
  );
}
```

### æ‹¦æˆªå™¨é…ç½®

```dart
@module
abstract class ApiModule {
  @singleton
  Dio provideDio() {
    final dio = Dio();

    dio.options = BaseOptions(
      baseUrl: 'http://154.44.25.92:8080',
      connectTimeout: const Duration(seconds: 10),
      receiveTimeout: const Duration(seconds: 10),
      sendTimeout: const Duration(seconds: 10),
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
        'User-Agent': 'JiSu-Fund-Analyzer/1.0',
        'Accept-Encoding': 'gzip, deflate',
      },
    );

    // æ·»åŠ æ‹¦æˆªå™¨
    dio.interceptors.addAll([
      _LoggingInterceptor(),
      _CacheInterceptor(),
      _ErrorInterceptor(),
      _RetryInterceptor(),
    ]);

    return dio;
  }
}
```

## ğŸ§­ è·¯ç”±æ¶æ„

### è·¯ç”±é…ç½®

```dart
class AppRouter {
  static final GoRouter router = GoRouter(
    initialLocation: '/exploration',
    debugLogDiagnostics: kDebugMode,
    errorBuilder: (context, state) => _ErrorPage(error: state.error),
    routes: [
      // å¤–å£³è·¯ç”± - åº•éƒ¨å¯¼èˆª
      ShellRoute(
        builder: (context, state, child) {
          return NavigationShell(child: child);
        },
        routes: [
          // ä¸»é¡µ - åŸºé‡‘æ¢ç´¢
          GoRoute(
            path: '/exploration',
            name: 'exploration',
            builder: (context, state) => const FundExplorationPage(),
            routes: [
              // åŸºé‡‘è¯¦æƒ…é¡µ
              GoRoute(
                path: '/fund/:fundCode',
                name: 'fund_detail',
                builder: (context, state) {
                  final fundCode = state.pathParameters['fundCode']!;
                  return FundDetailPage(fundCode: fundCode);
                },
              ),
              // å¯¹æ¯”é¡µé¢
              GoRoute(
                path: '/compare',
                name: 'compare',
                builder: (context, state) {
                  final funds = state.extra as List<String>? ?? [];
                  return FundComparisonPage(initialFunds: funds);
                },
              ),
            ],
          ),

          // å…¶ä»–å¯¼èˆªé¡µé¢...
        ],
      ),
    ],
  );
}
```

## ğŸ¨ æ ·å¼æŒ‡å¯¼æ–¹é’ˆ

### ä¸»é¢˜é…ç½®

```dart
class AppTheme {
  static const Color primaryColor = Color(0xFF1565C0);
  static const Color secondaryColor = Color(0xFF42A5F5);
  static const Color accentColor = Color(0xFF00BCD4);

  // é‡‘èæ•°æ®ä¸“ç”¨è‰²å½©
  static const Color profitColor = Color(0xFF4CAF50);
  static const Color lossColor = Color(0xFFE53935);
  static const Color neutralColor = Color(0xFF757575);

  static ThemeData get lightTheme {
    return ThemeData(
      useMaterial3: true,
      colorScheme: const ColorScheme.light(
        primary: primaryColor,
        secondary: secondaryColor,
        tertiary: accentColor,
        surface: Colors.white,
        background: Color(0xFFFAFAFA),
        error: Colors.red,
      ),

      textTheme: const TextTheme(
        headlineLarge: TextStyle(
          fontSize: 32,
          fontWeight: FontWeight.w500,
          color: Color(0xFF263238),
        ),
        bodyLarge: TextStyle(
          fontSize: 16,
          fontWeight: FontWeight.normal,
          color: Color(0xFF263238),
        ),
      ),

      cardTheme: CardTheme(
        color: Colors.white,
        elevation: 2,
        shadowColor: Colors.black.withOpacity(0.1),
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(12),
        ),
      ),
    );
  }
}

// é‡‘èæ•°æ®ä¸“ç”¨æ ·å¼
class FinancialTextStyles {
  static TextStyle get profitRate => const TextStyle(
    fontSize: 16,
    fontWeight: FontWeight.bold,
    color: AppColors.profit,
  );

  static TextStyle get lossRate => const TextStyle(
    fontSize: 16,
    fontWeight: FontWeight.bold,
    color: AppColors.loss,
  );
}
```

## ğŸ§ª æµ‹è¯•è¦æ±‚

### æµ‹è¯•ç­–ç•¥

1. **ç»„ä»¶æµ‹è¯•è¦†ç›–ç‡**: â‰¥ 80%
2. **ä¸šåŠ¡é€»è¾‘æµ‹è¯•è¦†ç›–ç‡**: â‰¥ 90%
3. **æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•è¦†ç›–ç‡**: 100%
4. **æ€»ä½“æµ‹è¯•è¦†ç›–ç‡**: â‰¥ 85%

### ç»„ä»¶æµ‹è¯•æ¨¡æ¿

```dart
testWidgets('should display loading state initially', (WidgetTester tester) async {
  // Arrange
  when(mockRepository.methodName())
      .thenAnswer((_) async => []);

  // Act
  await tester.pumpWidget(createWidgetUnderTest());

  // Assert
  expect(find.byType(CircularProgressIndicator), findsOneWidget);
});

testWidgets('should display data when loaded successfully', (WidgetTester tester) async {
  // Arrange
  final mockData = [TestDataFactory.createMockModel()];

  when(mockRepository.methodName())
      .thenAnswer((_) async => mockData);

  // Act
  await tester.pumpWidget(createWidgetUnderTest());
  await tester.pumpAndSettle();

  // Assert
  expect(find.text('Test Fund'), findsOneWidget);
});
```

## âš™ï¸ ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡

```dart
enum Environment {
  development,
  staging,
  production,
}

@immutable
class AppConfig {
  final Environment environment;
  final String apiBaseUrl;
  final String apiVersion;
  final Duration apiTimeout;
  final bool enableLogging;
  final bool enableAnalytics;
  final bool enableCrashReporting;

  const AppConfig._({
    required this.environment,
    required this.apiBaseUrl,
    required this.apiVersion,
    required this.apiTimeout,
    required this.enableLogging,
    required this.enableAnalytics,
    required this.enableCrashReporting,
  });

  // å¼€å‘ç¯å¢ƒé…ç½®
  static const AppConfig development = AppConfig._(
    environment: Environment.development,
    apiBaseUrl: 'http://154.44.25.92:8080',
    apiVersion: 'v1',
    apiTimeout: Duration(seconds: 30),
    enableLogging: true,
    enableAnalytics: false,
    enableCrashReporting: false,
  );

  // ç”Ÿäº§ç¯å¢ƒé…ç½®
  static const AppConfig production = AppConfig._(
    environment: Environment.production,
    apiBaseUrl: 'https://api.jisu-fund.com',
    apiVersion: 'v1',
    apiTimeout: Duration(seconds: 10),
    enableLogging: false,
    enableAnalytics: true,
    enableCrashReporting: true,
  );

  static AppConfig get currentConfig {
    if (kDebugMode) {
      return development;
    } else {
      return production;
    }
  }
}
```

## ğŸ¯ å‰ç«¯å¼€å‘è€…æ ‡å‡†

### å…³é”®ç¼–ç è§„åˆ™

1. **BLoCæ¨¡å¼å¿…é¡»éµå¾ª**
   - äº‹ä»¶ã€çŠ¶æ€ã€BLoCåˆ†ç¦»
   - çŠ¶æ€ä¸å¯å˜ï¼Œä½¿ç”¨copyWith
   - å¼‚æ­¥æ“ä½œåœ¨BLoCä¸­å¤„ç†

2. **ç»„ä»¶å¿…é¡»å“åº”å¼**
   - ä½¿ç”¨BlocBuilderæˆ–BlocListener
   - å¤„ç†æ‰€æœ‰çŠ¶æ€æƒ…å†µ
   - æä¾›åŠ è½½ã€é”™è¯¯ã€ç©ºçŠ¶æ€å¤„ç†

3. **é”™è¯¯å¤„ç†å¿…é¡»å®Œå–„**
   - APIè°ƒç”¨å¿…é¡»æœ‰try-catch
   - å‘ç”¨æˆ·æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯
   - æä¾›é‡è¯•æœºåˆ¶

4. **æ€§èƒ½ä¼˜åŒ–å¿…é¡»è€ƒè™‘**
   - ä½¿ç”¨constæ„é€ å‡½æ•°
   - é¿å…ä¸å¿…è¦çš„widgeté‡å»º
   - ä½¿ç”¨ç¼“å­˜å‡å°‘ç½‘ç»œè¯·æ±‚

### å¿«é€Ÿå‚è€ƒ

**å¸¸ç”¨å‘½ä»¤:**
```bash
# å¼€å‘æœåŠ¡å™¨
flutter run -d windows

# æ„å»º
flutter build windows --release

# æµ‹è¯•
flutter test

# ä»£ç ç”Ÿæˆ
flutter packages pub run build_runner build
```

**å¸¸ç”¨å¯¼å…¥:**
```dart
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';
import 'package:equatable/equatable.dart';
```

**æ–‡ä»¶å‘½å:**
- ç»„ä»¶: `fund_card.dart`
- BLoC: `fund_search_bloc.dart`
- é¡µé¢: `fund_exploration_page.dart`

## ğŸ“‹ å˜æ›´æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | æè¿° | ä½œè€… |
|------|------|------|------|
| 2025-11-02 | 1.0 | åˆå§‹ç‰ˆæœ¬åˆ›å»º | Winston (Architect) |

---

**æ–‡æ¡£çŠ¶æ€ï¼š** âœ… å®Œæˆ
**åˆ›å»ºæ—¶é—´ï¼š** 2025-11-02
**æœ€åæ›´æ–°ï¼š** 2025-11-02
**ä¸‹æ¬¡å®¡æŸ¥ï¼š** é‡æ„å¼€å§‹å‰