# æ€§èƒ½æµ‹è¯•å¥—ä»¶

è¿™æ˜¯ Story 2.5 å‡†å®æ—¶æ•°æ®æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿçš„å®Œæ•´æ€§èƒ½æµ‹è¯•å¥—ä»¶ï¼ŒåŒ…å« 8 ä¸ªæ ¸å¿ƒæµ‹è¯•ç»„ä»¶ï¼Œå…¨é¢éªŒè¯æ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿçš„åŠŸèƒ½ã€ç¨³å®šæ€§ã€å…¼å®¹æ€§å’Œå®¹é”™æ€§ã€‚

## ğŸ§ª æµ‹è¯•ç»„ä»¶æ¦‚è§ˆ

### 1. å†…å­˜æ³„æ¼å’Œç¨³å®šæ€§è‡ªåŠ¨åŒ–æµ‹è¯•
- **æ–‡ä»¶**: `test/unit/core/performance/monitors/memory_leak_detector_test.dart`
- **åŠŸèƒ½**: æµ‹è¯•å†…å­˜æ³„æ¼æ£€æµ‹ã€å¯¹è±¡è·Ÿè¸ªã€è‡ªåŠ¨æ¸…ç†ç­‰åŠŸèƒ½
- **è¦†ç›–èŒƒå›´**:
  - å¯¹è±¡åˆ›å»ºå’Œé”€æ¯è·Ÿè¸ª
  - å†…å­˜æ³„æ¼æ£€æµ‹ç®—æ³•
  - å¼±å¼•ç”¨è‡ªåŠ¨æ¸…ç†
  - å†…å­˜ä½¿ç”¨è¶‹åŠ¿åˆ†æ

### 2. æ€§èƒ½å›å½’æµ‹è¯•å¥—ä»¶
- **æ–‡ä»¶**: `test/performance/performance_regression_test_suite.dart`
- **åŠŸèƒ½**: æ£€æµ‹æ€§èƒ½ä¼˜åŒ–ç»„ä»¶æ˜¯å¦å‡ºç°æ€§èƒ½é€€åŒ–
- **è¦†ç›–èŒƒå›´**:
  - ä¸å†å²åŸºå‡†æ•°æ®å¯¹æ¯”
  - æ€§èƒ½å˜åŒ–è¶‹åŠ¿åˆ†æ
  - è‡ªåŠ¨åŒ–å›å½’æ£€æµ‹
  - æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ

### 3. è®¾å¤‡å’Œç½‘ç»œç¯å¢ƒå…¼å®¹æ€§æµ‹è¯•
- **æ–‡ä»¶**: `test/integration/device_network_compatibility_test.dart`
- **åŠŸèƒ½**: éªŒè¯åœ¨ä¸åŒè®¾å¤‡å’Œç½‘ç»œç¯å¢ƒä¸‹çš„å…¼å®¹æ€§
- **è¦†ç›–èŒƒå›´**:
  - ä½ç«¯è®¾å¤‡æ€§èƒ½ä¼˜åŒ–
  - é«˜ç«¯è®¾å¤‡æ€§èƒ½åˆ©ç”¨
  - ä¸åŒç½‘ç»œæ¡ä»¶é€‚åº”
  - è·¨å¹³å°å…¼å®¹æ€§

### 4. æ€§èƒ½åŸºå‡†å¯¹æ¯”å’ŒéªŒè¯æµ‹è¯•
- **æ–‡ä»¶**: `test/performance/performance_benchmark_test.dart`
- **åŠŸèƒ½**: å»ºç«‹æ€§èƒ½åŸºå‡†å¹¶è¿›è¡Œå¯¹æ¯”éªŒè¯
- **è¦†ç›–èŒƒå›´**:
  - å†…å­˜ç®¡ç†åŸºå‡†
  - æ‰¹æ¬¡å¤„ç†åŸºå‡†
  - å‹ç¼©ç®—æ³•åŸºå‡†
  - ç³»ç»Ÿæ•´ä½“æ€§èƒ½éªŒè¯

### 5. å¼‚å¸¸åœºæ™¯æ¢å¤å’Œå®¹é”™æµ‹è¯•
- **æ–‡ä»¶**: `test/integration/error_recovery_resilience_test.dart`
- **åŠŸèƒ½**: æµ‹è¯•ç³»ç»Ÿåœ¨å¼‚å¸¸æƒ…å†µä¸‹çš„æ¢å¤èƒ½åŠ›å’Œå®¹é”™æ€§
- **è¦†ç›–èŒƒå›´**:
  - ç»„ä»¶å´©æºƒæ¢å¤
  - æ•°æ®æŸåå¤„ç†
  - çº§è”å¤±è´¥åº”å¯¹
  - èµ„æºè€—å°½æ¢å¤

### 6. æ™ºèƒ½æ‰¹æ¬¡å¤„ç†å™¨æµ‹è¯•
- **æ–‡ä»¶**: `test/unit/core/performance/processors/smart_batch_processor_test.dart`
- **åŠŸèƒ½**: å…¨é¢æµ‹è¯•æ™ºèƒ½æ‰¹æ¬¡å¤„ç†å™¨çš„å„ç§åŠŸèƒ½
- **è¦†ç›–èŒƒå›´**:
  - æ‰¹æ¬¡å¤§å°è‡ªé€‚åº”
  - å¹¶å‘å¤„ç†èƒ½åŠ›
  - é”™è¯¯å¤„ç†æœºåˆ¶
  - æ€§èƒ½ä¼˜åŒ–éªŒè¯

### 7. èƒŒå‹æ§åˆ¶å™¨æµ‹è¯•
- **æ–‡ä»¶**: `test/unit/core/performance/processors/backpressure_controller_test.dart`
- **åŠŸèƒ½**: æµ‹è¯•èƒŒå‹æ§åˆ¶æœºåˆ¶çš„æœ‰æ•ˆæ€§
- **è¦†ç›–èŒƒå›´**:
  - å‹åŠ›æ£€æµ‹å‡†ç¡®æ€§
  - ç­–ç•¥é€‰æ‹©æ™ºèƒ½æ€§
  - èŠ‚æµæ§åˆ¶æ•ˆæœ
  - é€‚åº”æ€§è¡Œä¸ºéªŒè¯

### 8. è‡ªé€‚åº”æ‰¹æ¬¡å¤§å°è°ƒæ•´å™¨æµ‹è¯•
- **æ–‡ä»¶**: `test/unit/core/performance/processors/adaptive_batch_sizer_test.dart`
- **åŠŸèƒ½**: éªŒè¯è‡ªé€‚åº”æ‰¹æ¬¡å¤§å°è°ƒæ•´çš„æ™ºèƒ½åŒ–ç¨‹åº¦
- **è¦†ç›–èŒƒå›´**:
  - è´Ÿè½½æ„ŸçŸ¥è°ƒæ•´
  - å†å²æ€§èƒ½å­¦ä¹ 
  - é¢„æµ‹æ€§ä¼˜åŒ–
  - ç¨³å®šæ€§ä¿è¯

### 9. ä½å¼€é”€ç›‘æ§å™¨æµ‹è¯•
- **æ–‡ä»¶**: `test/unit/core/performance/services/low_overhead_monitor_test.dart`
- **åŠŸèƒ½**: ç¡®ä¿ç›‘æ§ç³»ç»Ÿæœ¬èº«ä¸ä¼šå¼•å…¥è¿‡å¤šå¼€é”€
- **è¦†ç›–èŒƒå›´**:
  - å¼€é”€æ§åˆ¶éªŒè¯
  - æ™ºèƒ½é‡‡æ ·æ•ˆç‡
  - ç›‘æ§å‡†ç¡®æ€§
  - èµ„æºä½¿ç”¨ä¼˜åŒ–

## ğŸš€ è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
# è¿è¡Œå®Œæ•´çš„æ€§èƒ½æµ‹è¯•å¥—ä»¶
dart test/performance/test_runner.dart

# æˆ–è€…ä½¿ç”¨ Flutter Test
flutter test test/performance/
```

### è¿è¡Œç‰¹å®šæµ‹è¯•ç»„ä»¶
```bash
# è¿è¡Œå†…å­˜æ³„æ¼æ£€æµ‹æµ‹è¯•
flutter test test/unit/core/performance/monitors/memory_leak_detector_test.dart

# è¿è¡Œæ‰¹æ¬¡å¤„ç†å™¨æµ‹è¯•
flutter test test/unit/core/performance/processors/smart_batch_processor_test.dart

# è¿è¡ŒèƒŒå‹æ§åˆ¶å™¨æµ‹è¯•
flutter test test/unit/core/performance/processors/backpressure_controller_test.dart

# è¿è¡Œè‡ªé€‚åº”æ‰¹æ¬¡å¤§å°è°ƒæ•´å™¨æµ‹è¯•
flutter test test/unit/core/performance/processors/adaptive_batch_sizer_test.dart

# è¿è¡Œä½å¼€é”€ç›‘æ§å™¨æµ‹è¯•
flutter test test/unit/core/performance/services/low_overhead_monitor_test.dart

# è¿è¡Œå…¼å®¹æ€§æµ‹è¯•
flutter test test/integration/device_network_compatibility_test.dart

# è¿è¡Œå®¹é”™æµ‹è¯•
flutter test test/integration/error_recovery_resilience_test.dart
```

### å¿«é€Ÿæ€§èƒ½æ£€æŸ¥
```bash
# è¿è¡Œå¿«é€Ÿæ€§èƒ½æ£€æŸ¥ï¼ˆçº¦1åˆ†é’Ÿï¼‰
dart test/performance/test_runner.dart --quick
```

### è¿è¡Œå‹åŠ›æµ‹è¯•
```bash
# è¿è¡Œå‹åŠ›æµ‹è¯•ï¼ˆé»˜è®¤5åˆ†é’Ÿï¼‰
dart test/performance/test_runner.dart --stress

# è‡ªå®šä¹‰å‹åŠ›æµ‹è¯•å‚æ•°
dart test/performance/test_runner.dart --stress --duration 300 --users 50 --rps 200
```

### è·³è¿‡ç‰¹å®šæµ‹è¯•ç±»å‹
```bash
# è·³è¿‡å›å½’æµ‹è¯•
dart test/performance/test_runner.dart --no-regression

# è·³è¿‡å…¼å®¹æ€§æµ‹è¯•
dart test/performance/test_runner.dart --no-compatibility

# è·³è¿‡åŸºå‡†æµ‹è¯•
dart test/performance/test_runner.dart --no-benchmark

# è·³è¿‡å®¹é”™æµ‹è¯•
dart test/performance/test_runner.dart --no-resilience
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåï¼ŒæŠ¥å‘Šå°†ä¿å­˜åœ¨ä»¥ä¸‹ä½ç½®ï¼š

- **æµ‹è¯•æŠ¥å‘Š**: `test/performance/reports/`
- **åŸºå‡†æ•°æ®**: `test/performance/benchmarks/`
- **å›å½’å¯¹æ¯”**: `test/performance/results/`
- **è¦†ç›–ç‡æŠ¥å‘Š**: `coverage/lcov.info`

### æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
flutter test --coverage

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
genhtml coverage/lcov.info -o coverage/html
open coverage/html/index.html
```

## ğŸ¯ æ€§èƒ½åŸºå‡†

### å†…å­˜ç®¡ç†åŸºå‡†
- **å†…å­˜åˆ†é…**: < 100Î¼s å¹³å‡æ—¶é—´
- **ç¼“å­˜è®¿é—®**: < 50Î¼s å¹³å‡æ—¶é—´ï¼Œ> 80% å‘½ä¸­ç‡
- **å†…å­˜æ¸…ç†**: < 1ç§’ï¼Œ> 50% æ•ˆç‡

### æ‰¹æ¬¡å¤„ç†åŸºå‡†
- **å°æ‰¹æ¬¡å¤„ç†**: < 500msï¼Œ> 1000 é¡¹ç›®/ç§’
- **å¤§æ‰¹æ¬¡å¤„ç†**: < 5ç§’ï¼Œ> 5000 é¡¹ç›®/ç§’
- **è‡ªé€‚åº”è°ƒæ•´**: < 1msï¼Œ> 10% æ€§èƒ½æ”¹å–„

### å‹ç¼©æ€§èƒ½åŸºå‡†
- **å‹ç¼©æ¯”**: > 1.0x
- **å‹ç¼©æ—¶é—´**: < 1ç§’
- **è§£å‹æ—¶é—´**: < 500ms
- **CPUä½¿ç”¨ç‡**: < 80%

### ç›‘æ§å¼€é”€åŸºå‡†
- **ç›‘æ§å¼€é”€**: < 0.5%
- **é‡‡æ ·ç‡**: > 10Hz
- **ç›‘æ§å‡†ç¡®æ€§**: > 90%

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Flutter 3.13.0+
- Dart 3.1.0+
- è¶³å¤Ÿçš„ç³»ç»Ÿèµ„æºï¼ˆæ¨è 8GB+ RAMï¼‰

### æµ‹è¯•é…ç½®
æµ‹è¯•é…ç½®æ–‡ä»¶ä½äºï¼š
- `test/unit/core/performance/performance_test_base.dart` - åŸºç¡€æµ‹è¯•é…ç½®
- å„ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­çš„ `setUp` æ–¹æ³• - ç»„ä»¶ç‰¹å®šé…ç½®

### è‡ªå®šä¹‰é…ç½®
å¯ä»¥é€šè¿‡ä¿®æ”¹æµ‹è¯•æ–‡ä»¶ä¸­çš„é…ç½®å‚æ•°æ¥è°ƒæ•´æµ‹è¯•è¡Œä¸ºï¼š

```dart
// ç¤ºä¾‹ï¼šè°ƒæ•´æµ‹è¯•è¶…æ—¶æ—¶é—´
const Duration defaultTimeout = Duration(minutes: 10);

// ç¤ºä¾‹ï¼šè°ƒæ•´æ€§èƒ½åŸºå‡†
const int throughputThreshold = 1000;
const double errorRateThreshold = 0.01;
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æµ‹è¯•è¶…æ—¶
```
è§£å†³æ–¹æ¡ˆ:
- å¢åŠ æµ‹è¯•è¶…æ—¶æ—¶é—´
- æ£€æŸ¥ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
- å‡å°‘å¹¶å‘æµ‹è¯•æ•°é‡
```

#### 2. å†…å­˜ä¸è¶³
```
è§£å†³æ–¹æ¡ˆ:
- å‡å°‘æµ‹è¯•æ•°æ®é‡
- å¢åŠ ç³»ç»Ÿå†…å­˜
- åˆ†æ‰¹è¿è¡Œæµ‹è¯•
```

#### 3. ç»„ä»¶åˆå§‹åŒ–å¤±è´¥
```
è§£å†³æ–¹æ¡ˆ:
- æ£€æŸ¥ä¾èµ–é¡¹æ˜¯å¦æ­£ç¡®
- éªŒè¯Mockå¯¹è±¡é…ç½®
- æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
```

#### 4. æ€§èƒ½åŸºå‡†ä¸è¾¾æ ‡
```
è§£å†³æ–¹æ¡ˆ:
- æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½
- ä¼˜åŒ–æµ‹è¯•ç¯å¢ƒ
- è°ƒæ•´æ€§èƒ½æœŸæœ›å€¼
```

### è°ƒè¯•æŠ€å·§

#### å¯ç”¨è¯¦ç»†æ—¥å¿—
```bash
flutter test --verbose
```

#### è¿è¡Œç‰¹å®šæµ‹è¯•ç”¨ä¾‹
```bash
flutter test --name "test_case_name"
```

#### æŸ¥çœ‹è¯¦ç»†å †æ ˆè·Ÿè¸ª
```bash
flutter test --stack-trace
```

## ğŸ“ˆ æŒç»­é›†æˆ

### CI/CD é›†æˆ
```yaml
# .github/workflows/performance_tests.yml
name: Performance Tests

on: [push, pull_request]

jobs:
  performance-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.13.0'
      - run: flutter pub get
      - run: dart test/performance/test_runner.dart --quick
      - run: flutter test --coverage
      - uses: codecov/codecov-action@v3
```

### è‡ªåŠ¨åŒ–æ€§èƒ½ç›‘æ§
```bash
# è®¾ç½®å®šæ—¶ä»»åŠ¡è¿è¡Œæ€§èƒ½æµ‹è¯•
crontab -e

# æ¯å¤©å‡Œæ™¨2ç‚¹è¿è¡Œå¿«é€Ÿæ£€æŸ¥
0 2 * * * cd /path/to/project && dart test/performance/test_runner.dart --quick

# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹è¿è¡Œå®Œæ•´æµ‹è¯•
0 3 * * 0 cd /path/to/project && dart test/performance/test_runner.dart
```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Flutter Testing Documentation](https://docs.flutter.dev/testing)
- [Dart Testing Documentation](https://dart.dev/guides/testing)
- [Performance Testing Best Practices](https://docs.flutter.dev/testing/best-practices)
- [Clean Architecture Testing Guide](https://docs.flutter.dev/testing/overview)

---

## ğŸ¤ è´¡çŒ®

å¦‚æœæ‚¨å‘ç°æµ‹è¯•é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œè¯·ï¼š

1. åˆ›å»º Issue æè¿°é—®é¢˜
2. æäº¤ Pull Request ä¿®å¤é—®é¢˜
3. æ›´æ–°ç›¸å…³æ–‡æ¡£

æ„Ÿè°¢æ‚¨ä¸ºæ€§èƒ½ä¼˜åŒ–ç³»ç»Ÿè´¨é‡ä¿è¯çš„è´¡çŒ®ï¼